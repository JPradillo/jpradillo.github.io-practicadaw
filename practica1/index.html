
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mydomain.org/mysite/practica1/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../practica2/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Práctica 2.1 - Practicas</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#practica-21" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Practicas" class="md-header__button md-logo" aria-label="Practicas" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Practicas
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Práctica 2.1
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Practicas" class="md-nav__button md-logo" aria-label="Practicas" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Practicas
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tema2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Tema2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Teoría
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prácticas
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Prácticas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Práctica 2.1
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Práctica 2.1
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#instalacion-servidor-web-nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación servidor web Nginx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creacion-de-las-carpeta-del-sitio-web" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de las carpeta del sitio web
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-servidor-web-nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración de servidor web NGINX
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comprobaciones" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobaciones
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comprobaciones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comprobacion-del-correcto-funcionamiento" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobación del correcto funcionamiento
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobar-registros-del-servidor" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobar registros del servidor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ftp" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FTP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#como-transferir-archivos-desde-nuestra-maquina-localanfitrion-a-nuestra-maquina-virtual-debianservidor-remoto" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Cómo transferir archivos desde nuestra máquina local/anfitrión a nuestra máquina virtual Debian/servidor remoto?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurar-servidor-sftp-en-debian" class="md-nav__link">
    <span class="md-ellipsis">
      Configurar servidor SFTP en Debian
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#https" class="md-nav__link">
    <span class="md-ellipsis">
      HTTPS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTTPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redireccion-http-a-https" class="md-nav__link">
    <span class="md-ellipsis">
      Redirección HTTP a HTTPS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuestiones-finales" class="md-nav__link">
    <span class="md-ellipsis">
      Cuestiones finales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cuestiones finales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cuestion-1" class="md-nav__link">
    <span class="md-ellipsis">
      🟦 Cuestión 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cuestion-2" class="md-nav__link">
    <span class="md-ellipsis">
      🟦 Cuestión 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../practica2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 2.2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../practica3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 2.3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../practica4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 2.4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../practica5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Práctica 2.5
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#instalacion-servidor-web-nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación servidor web Nginx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creacion-de-las-carpeta-del-sitio-web" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de las carpeta del sitio web
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-servidor-web-nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración de servidor web NGINX
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comprobaciones" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobaciones
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comprobaciones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comprobacion-del-correcto-funcionamiento" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobación del correcto funcionamiento
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobar-registros-del-servidor" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobar registros del servidor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ftp" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FTP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#como-transferir-archivos-desde-nuestra-maquina-localanfitrion-a-nuestra-maquina-virtual-debianservidor-remoto" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Cómo transferir archivos desde nuestra máquina local/anfitrión a nuestra máquina virtual Debian/servidor remoto?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurar-servidor-sftp-en-debian" class="md-nav__link">
    <span class="md-ellipsis">
      Configurar servidor SFTP en Debian
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#https" class="md-nav__link">
    <span class="md-ellipsis">
      HTTPS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTTPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redireccion-http-a-https" class="md-nav__link">
    <span class="md-ellipsis">
      Redirección HTTP a HTTPS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuestiones-finales" class="md-nav__link">
    <span class="md-ellipsis">
      Cuestiones finales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cuestiones finales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cuestion-1" class="md-nav__link">
    <span class="md-ellipsis">
      🟦 Cuestión 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cuestion-2" class="md-nav__link">
    <span class="md-ellipsis">
      🟦 Cuestión 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="practica-21">Práctica 2.1</h1>
<h2 id="instalacion-servidor-web-nginx">Instalación servidor web Nginx</h2>
<p>Para instalar el servidor nginx en nuestra Debian, primero actualizamos 
los repositorios y después instalamos el paquete correspondiente:</p>
<p><code>sudo apt update</code>
<code>sudo apt install nginx</code></p>
<p><img alt="Paso 1" src="../assets/images/practica2_1/Instalacion_paso1.png" /></p>
<p>Comprobamos que nginx se ha instalado y que está funcionando correctamente:</p>
<p><code>systemctl status nginx</code></p>
<p><img alt="Paso 2" src="../assets/images/practica2_1/Instalacion_paso2.png" /></p>
<h2 id="creacion-de-las-carpeta-del-sitio-web">Creación de las carpeta del sitio web</h2>
<p>Igual que ocurre en Apache, todos los archivos que formarán parte de un sitio web que servirá nginx se organizarán en carpetas. Estas carpetas, típicamente están dentro de /var/www.</p>
<p>Así pues, vamos a crear la carpeta de nuestro sitio web o dominio:</p>
<p><code>sudo mkdir -p /var/www/nombre_web/html</code></p>
<p><img alt="Paso 3" src="../assets/images/practica2_1/Instalacion_paso3.png" /></p>
<p>Dentro de esa carpeta html, debéis clonar el siguiente repositorio:</p>
<p><code>https://github.com/cloudacademy/static-website-example</code></p>
<p><img alt="Paso 4" src="../assets/images/practica2_1/Instalacion_paso4.png" /></p>
<p>Además, haremos que el propietario de esta carpeta y todo lo que haya dentro 
sea el usuario www-data, típicamente el usuario del servicio web.</p>
<p><code>sudo chown -R www-data:www-data /var/www/nombre_web/html</code></p>
<p><img alt="Paso 5" src="../assets/images/practica2_1/Instalacion_paso5.png" /></p>
<p>Y le daremos los permisos adecuados para que no nos de un error de acceso 
no autorizado al entrar en el sitio web:</p>
<p><code>sudo chmod -R 755 /var/www/nombre_web</code></p>
<p><img alt="Paso 6" src="../assets/images/practica2_1/Instalacion_paso6.png" /></p>
<p>Para comprobar que el servidor está funcionando y sirviendo páginas 
correctamente, podéis acceder desde vuestro cliente a:</p>
<p><code>http://IP-maq-virtual</code></p>
<p><img alt="IP" src="../assets/images/practica2_1/SFTP_IP.png" /></p>
<p>Y os deberá aparecer algo así:</p>
<p><img alt="Paso 7" src="../assets/images/practica2_1/Instalacion_paso7.png" /></p>
<p>Lo que demuestra que todo es correcto hasta ahora.</p>
<h2 id="configuracion-de-servidor-web-nginx">Configuración de servidor web NGINX</h2>
<p>En Nginx hay dos rutas importantes. La primera de ellas es sites-available, que contiene los archivos de configuración de los hosts virtuales o bloques disponibles en el servidor. Es decir, cada uno de los sitios webs que alberga el servido. La otra es sites-enabled, que contiene los archivos de configuración de los sitios habilitados, es decir, los que funcionan en ese momento.</p>
<p>Dentro de sites-available hay un archivo de configuración por defecto (default), que es la página que se muestra si accedemos al servidor sin indicar ningún sitio web o cuando el sitio web no es encontrado en el servidor (debido a una mala configuración por ejemplo). Esta es la página que nos ha aparecido en el apartado anterior.</p>
<p>Para que Nginx presente el contenido de nuestra web, es necesario crear un bloque de servidor con las directivas correctas. En vez de modificar el archivo de configuración predeterminado directamente, crearemos uno nuevo en /etc/nginx/sites-available/nombre_web:</p>
<p><code>sudo nano /etc/nginx/sites-available/vuestro_dominio</code></p>
<p><img alt="Paso 8" src="../assets/images/practica2_1/Configuracion_paso1.png" /></p>
<p>Y el contenido de ese archivo de configuración:</p>
<pre><code class="language-code">server {
        listen 80;
        listen [::]:80;
        root /ruta/absoluta/archivo/index;
        index index.html index.htm index.nginx-debian.html;
        server_name nombre_web;
        location / {
                try_files $uri $uri/ =404;
        }
}
</code></pre>
<p><img alt="Paso 9" src="../assets/images/practica2_1/Configuracion_paso2.png" /></p>
<p>Aquí la directiva root debe ir seguida de la ruta absoluta absoluta dónde se encuentre el archivo index.html de nuestra página web, que se encuentra entre todos los que habéis descomprimido.</p>
<p>Y crearemos un archivo simbólico entre este archivo y el de sitios que están habilitados, para que se dé de alta automáticamente.</p>
<p><code>sudo ln -s /etc/nginx/sites-available/nombre_web /etc/nginx/sites-enabled/</code></p>
<p><img alt="Paso 10" src="../assets/images/practica2_1/Configuracion_paso3.png" /></p>
<p>Y reiniciamos el servidor para aplicar la configuración:</p>
<p><code>sudo systemctl restart nginx</code></p>
<p><img alt="Paso 11" src="../assets/images/practica2_1/Configuracion_paso4.png" /></p>
<h2 id="comprobaciones">Comprobaciones</h2>
<h4 id="comprobacion-del-correcto-funcionamiento">Comprobación del correcto funcionamiento</h4>
<p>Como aún no poseemos un servidor DNS que traduzca los nombres a IPs, debemos hacerlo de forma manual. Vamos a editar el archivo /etc/hosts de nuestra máquina anfitriona para que asocie la IP de la máquina virtual, a nuestro server_name.</p>
<p>Este archivo, en Linux, está en: <code>/etc/hosts</code></p>
<p>Y en Windows: <code>C:\Windows\System32\drivers\etc\hosts</code></p>
<p>Y deberemos añadirle la línea:</p>
<p><code>192.168.X.X nombre_web</code></p>
<p><img alt="Configuración" src="../assets/images/practica2_1/Configuracion.png" /></p>
<p>donde debéis sustituir la IP por la que tenga vuestra máquina virtual.</p>
<h4 id="comprobar-registros-del-servidor">Comprobar registros del servidor</h4>
<p>Comprobad que las peticiones se están registrando correctamente en los archivos de logs, tanto las correctas como las erróneas:
 - /var/log/nginx/access.log: cada solicitud a su servidor web se registra en este archivo de registro, a menos que Nginx esté configurado para hacer algo diferente.
 - /var/log/nginx/error.log: cualquier error de Nginx se asentará en este registro</p>
<blockquote>
<p>ℹ️ <strong>Información:</strong> Si no os aparece nada en los logs, podría pasar que el navegador ha cacheado la página web y que, por tanto, ya no está obteniendo la página del navegador sino de la propia memoria. Para solucionar esto, podéis acceder con el modo privado del navegador y ya os debería registrar esa actividad en los logs.</p>
</blockquote>
<h2 id="ftp">FTP</h2>
<p>Si queremos tener varios dominios o sitios web en el mismo servidor nginx (es decir, que tendrán la misma IP) debemos repetir todo el proceso anterior con el nuevo nombre de dominio que queramos configurar.</p>
<h5 id="como-transferir-archivos-desde-nuestra-maquina-localanfitrion-a-nuestra-maquina-virtual-debianservidor-remoto">¿Cómo transferir archivos desde nuestra máquina local/anfitrión a nuestra máquina virtual Debian/servidor remoto?</h5>
<p>A día de hoy el proceso más sencillo y seguro es a través de Github como hemos visto antes. No obstante, el currículum de la Consellería d'Educació me obliga a enseñaros un método un tanto obsoleto a día de hoy, así que vamos a ello, os presento al FTP.</p>
<p>El FTP es un protocolo de transferencia de archivos entre sistemas conectados a una red TCP. Como su nombre indica, se trata de un protocolo que permite transferir archivos directamente de un dispositivo a otro. Actualmente, es un protocolo que poco a poco va abandonándose, pero ha estado vigente más de 50 años.</p>
<p>El protocolo FTP tal cual es un protocolo inseguro, ya que su información no viaja cifrada. Sin embargo, en 2001 esto se solucionó con el protocolo SFTP, que le añade una capa SSH para hacerlo más seguro y privado.</p>
<p>SFTP no es más que el mismo protocolo FTP pero implementado por un canal seguro. Son las siglas de SSH File Transfer Protocol y consiste en una extensión de Secure Shell Protocol (SSH) creada para poder hacer transmisiones de archivos.</p>
<p>La seguridad que nos aporta SFTP es importante para la transferencia de archivos porque, si no disponemos de ella, los archivos viajarán tal cual por la red, sin ningún tipo de encriptación. Así pues, usando FTP tradicional, si algún agente consigue escuchar las transferencias, podría ocurrir que la información quedase al descubierto. Esto sería especialmente importante si los archivos que subimos contienen información confidencial o datos personales.</p>
<p>Dado que usar SFTP aporta mayor seguridad a las transmisiones, es recomendable utilizarlo, más aún sabiendo que realmente no hay mucha dificultad en establecer las conexiones por el protocolo seguro.</p>
<h4 id="configurar-servidor-sftp-en-debian">Configurar servidor SFTP en Debian</h4>
<p>En primer lugar, lo instalaremos desde los repositorios:</p>
<pre><code class="language-code">sudo apt-get update
sudo apt-get install vsftpd
</code></pre>
<p><img alt="Paso 13" src="../assets/images/practica2_1/SFTP_paso1.png" />
<img alt="Paso 14" src="../assets/images/practica2_1/SFTP_paso2.png" /></p>
<p>Ahora vamos a crear una carpeta en nuestro home en Debian:</p>
<p><code>mkdir /home/nombre_usuario/ftp</code></p>
<p><img alt="Paso 15" src="../assets/images/practica2_1/SFTP_paso3.png" /></p>
<p>En la configuración de vsftpd indicaremos que este será el directorio al cual vsftpd se cambia después de conectarse el usuario.</p>
<p>Ahora vamos a crear los certificados de seguridad necesarios para aportar la capa de cifrado a nuestra conexión (algo parecido a HTTPS)</p>
<p><code>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem</code></p>
<p><img alt="Paso 16" src="../assets/images/practica2_1/SFTP_paso4.png" />
<img alt="Paso 17" src="../assets/images/practica2_1/SFTP_paso5.png" /></p>
<p>Y una vez realizados estos pasos, procedemos a realizar la configuración de vsftpd propiamente dicha. Se trata, con el editor de texto que más os guste, de editar el archivo de configuración de este servicio, por ejemplo con nano:</p>
<p><code>sudo nano /etc/vsftpd.conf</code></p>
<p><img alt="Paso 18" src="../assets/images/practica2_1/SFTP_paso6.png" /></p>
<p>En primer lugar, buscaremos las siguientes líneas del archivo y las eliminaremos por completo:</p>
<pre><code class="language-code">rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem
rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key
ssl_enable=NO
</code></pre>
<p>Tras ello, añadiremos estas líneas en su lugar</p>
<pre><code class="language-code">rsa_cert_file=/etc/ssl/private/vsftpd.pem
rsa_private_key_file=/etc/ssl/private/vsftpd.pem
ssl_enable=YES
allow_anon_ssl=NO
force_local_data_ssl=YES
force_local_logins_ssl=YES
ssl_tlsv1=YES
ssl_sslv2=NO
ssl_sslv3=NO
require_ssl_reuse=NO
ssl_ciphers=HIGH

local_root=/home/nombre_usuario/ftp
</code></pre>
<p><img alt="Paso 19" src="../assets/images/practica2_1/SFTP_paso7.png" /></p>
<p>Y, tras guardar los cambios, reiniciamos el servicio para que coja la nueva configuración:</p>
<p><code>sudo systemctl restart --now vsftpd</code></p>
<p><img alt="Paso 20" src="../assets/images/practica2_1/SFTP_paso8.png" /></p>
<p>Tras acabar esta configuración, ya podremos acceder a nuestro servidor mediante un cliente FTP adecuado, como por ejemplo Filezilla de dos formas, a saber:
- Mediante el puerto por defecto del protocolo inseguro FTP, el 21, pero utilizando certificados que cifran el intercambio de datos convirtiéndolo así en seguro
- Haciendo uso del protocolo SFTP, dedicado al intercambio de datos mediante una conexión similar a SSH, utilizando de hecho el puerto 22.</p>
<p>Tras descargar el cliente FTP en nuestro ordenador, introducimos los datos necesarios para conectarnos a nuestro servidor FTP en Debian:</p>
<p><img alt="Paso 21" src="../assets/images/practica2_1/SFTP_paso9.png" /></p>
<ul>
<li>La IP de Debian</li>
<li>El nombre de usuario de Debian</li>
<li>La contraseña de ese usuario </li>
<li>El puerto de conexión, que será el 21 para conectarnos utilizando los certificados generados previamente</li>
</ul>
<p>Tras darle al botón de Conexión rápida, nos saltará un aviso a propósito del certificado, le damos a aceptar puesto que no entraña peligro ya que lo hemos genrado nosotros mismos:</p>
<p><img alt="Paso 22" src="../assets/images/practica2_1/SFTP_pasoo10.png" /></p>
<p>Nos conectaremos directamente a la carpeta que le habíamos indicado en el archivo de configuración /home/raul/ftp</p>
<p>Una vez conectados, buscamos la carpeta de nuestro ordenador donde hemos descargado el .zip (en la parte izquierda de la pantalla) y en la parte derecha de la pantalla, buscamos la carpeta donde queremos subirla. Con un doble click o utilizando botón derecho &gt; subir, la subimos al servidor.</p>
<p><img alt="Paso 23" src="../assets/images/practica2_1/SFTP_pasoo11.png" /></p>
<p>Si lo que quisiéramos es conectarnos por SFTP, exactamente igual de válido, haríamos:</p>
<p>Fijáos que al utilizar las claves de SSH que ya estamos utilizando desde la Práctica 1, no se debe introducir la contraseña, únicamente el nombre de usuario.</p>
<p>Puesto que nos estamos conectando usando las claves FTP, nos sale el mismo aviso que nos salía al conectarnos por primera vez por SSH a nuestra Debian, que aceptamos porque sabemos que no entraña ningún peligro en este caso:</p>
<p><img alt="Paso 24" src="../assets/images/practica2_1/SFTP_pasoo12.png" /></p>
<p><img alt="Paso 25" src="../assets/images/practica2_1/SFTP_pasoo13.png" /></p>
<p>Y vemos que al ser una especie de conexión SSH, nos conecta al home del usuario, en lugar de a la carpeta ftp. A partir de aquí ya procederíamos igual que en el otro caso.</p>
<p>Recordemos que debemos tener nuestro sitio web en la carpeta /var/www y darle los permisos adecuados, de forma similiar a cómo hemos hecho con el otro sitio web.</p>
<p>El comando que nos permite descomprimir un .zip en un directorio concreto es:</p>
<p><code>unzip archivo.zip -d /nombre/directorio</code></p>
<p><img alt="Paso 26" src="../assets/images/practica2_1/SFTP_pasoo14.png" /></p>
<p>Si no tuvieráis unzip instalado, lo instaláis:</p>
<p><code>sudo apt-get update &amp;&amp; sudo apt-get install unzip</code></p>
<h2 id="https">HTTPS</h2>
<p>En este apartado le añadiremos a nuestro servidor una capa de seguridad necesaria. Haremos que todos nuestros sitios web alojados hagan uso de certificados SSL y se acceda a ellos por medio de HTTPS.</p>
<p>Para ello, a modo de prueba de concepto, nos generaremos unos certificados autofirmados y, en el fichero de configuración de nuestros hosts virtuales (los sitios web que hemos configurado), deberemos cambiar los parámetros necesarios.</p>
<p>Apoyaos en una búsqueda en Internet para conseguir vuestro objetivo.</p>
<h4 id="redireccion-http-a-https">Redirección HTTP a HTTPS</h4>
<p>Cuando hayáis cumplido con la tarea de dotar de HTTPS a vuestros sitios web, podréis pasar a esta.</p>
<p>Fijáos que con el estado de la configuración actual, a vuestro sitio web se puede acceder aún de dos formas simultáneas, por el puerto 80 (HTTP e inseguro) y por el puerto 443 (HTTPS, seguro). Puesto que queremos dejar la configuración bien hecha y sin posibles fisuras, vuestro objetivo es que si el usuario accede a vuestro sitio web mediante el puerto 80 (HTTP) automáticamente, por motivos de seguridad, se le redirija a HTTPS, en el puerto 443.</p>
<p>Realizad la búsqueda de información adecuada para conseguir esta redirección automática mediante los cambios necesarios en vuestros archivos de hosts virtuales.</p>
<p>Primero que nada entraremos en el archivo:</p>
<p><code>sudo nano /etc/nginx/sites-available/practicadaw</code></p>
<p><img alt="Paso 27" src="../assets/images/practica2_1/HTTPS_paso1.png" /></p>
<p>Editar el script que había antes:</p>
<pre><code class="language-code">server {
    listen 80;
    listen [::]:80;
    server_name practicadaw;

    return 301 https://$server_name$request_uri;
}
</code></pre>
<p>y añadir debajo:</p>
<pre><code class="language-code">server {
    listen 443 ssl;
    listen [::]:443 ssl;
    server_name practicadaw;

    ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;
    ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;

    root /var/www/practicadaw/html/static-website-example/;
    index index.html index.htm index.nginx-debian.html;

    location / {
        try_files $uri $uri/ =404;
    }
}
</code></pre>
<p><img alt="Paso 28" src="../assets/images/practica2_1/HTTPS_paso2.png" /></p>
<p>Finalmente comprobamos que se nos abra la web y muestre este mensaje. Tras esto ya tendremos nuestra web con nginx desplegada.</p>
<p><img alt="Paso 29" src="../assets/images/practica2_1/HTTPS_paso3.png" /></p>
<h2 id="cuestiones-finales">Cuestiones finales</h2>
<h3 id="cuestion-1">🟦 Cuestión 1</h3>
<blockquote>
<p><strong>¿Qué pasa si no hago el link simbólico entre <code>sites-available</code> y <code>sites-enabled</code> de mi sitio web?</strong></p>
</blockquote>
<p>Si no haces el enlace simbólico entre <code>sites-available</code>y <code>sites-enabled</code></p>
<ul>
<li>Provocarás que tu sitio no esté activo, produciendo errores de acceso (como 404)</li>
<li>Aunque hayas hecho la configuración de <code>sites-available</code>, el servidor no las reconocerá.</li>
<li>Hay riesgo de errores en la configuración que podrían dar la impresión de que el servidor está funcionando después de reiniciarse o recargarse, cuando en realidad no lo está.</li>
<li>Pueden haber problemas en la administración de sitios por la dificultad a la hora de gestionar varias configuraciones de sitios, ya que no es posible habilitar o deshabilitar un sitio de manera fácil al agregar o eliminar el enlace en sites-enabled.</li>
</ul>
<h3 id="cuestion-2">🟦 Cuestión 2</h3>
<blockquote>
<p><strong>¿Qué pasa si no le doy los permisos adecuados a <code>/var/www/nombre_web</code>?</strong></p>
</blockquote>
<ul>
<li>El servidor web no podrá leer los archivos.</li>
<li>Si el sitio necesita escribir archivos fallará si no tiene permisos de escritura.</li>
<li>Otros usuarios o servicios que dependan de esos archivos no podrán acceder.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>